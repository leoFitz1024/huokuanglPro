<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.tmqt.dao.PaymentMapper">
  <resultMap id="BaseResultMap" type="com.tmqt.model.Payment">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="id" jdbcType="INTEGER" property="id" />
    <result column="type" jdbcType="INTEGER" property="type" />
    <result column="factoryid" jdbcType="INTEGER" property="factoryid" />
    <result column="month" jdbcType="TIMESTAMP" property="month" />
    <result column="money" jdbcType="REAL" property="money" />
    <result column="remarks" jdbcType="VARCHAR" property="remarks" />
    <result column="paytime" jdbcType="TIMESTAMP" property="paytime" />
    <result column="adddtime" jdbcType="TIMESTAMP" property="adddtime" />
  </resultMap>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    id, type, factoryid, month, money, remarks, paytime, adddtime
  </sql>
  <select id="selectByPrimaryKey" parameterType="java.lang.Integer" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select 
    <include refid="Base_Column_List" />
    from payment
    where id = #{id,jdbcType=INTEGER}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from payment
    where id = #{id,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="com.tmqt.model.Payment">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into payment (id, type, factoryid, 
      month, money, remarks, paytime,
      adddtime)
    values (#{id,jdbcType=INTEGER}, #{type,jdbcType=INTEGER}, #{factoryid,jdbcType=INTEGER}, 
      #{month,jdbcType=TIMESTAMP}, #{money,jdbcType=REAL}, #{remarks,jdbcType=VARCHAR}, #{paytime,jdbcType=TIMESTAMP},
      #{adddtime,jdbcType=TIMESTAMP})
  </insert>
  <insert id="insertSelective" parameterType="com.tmqt.model.Payment">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into payment
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="id != null">
        id,
      </if>
      <if test="type != null">
        type,
      </if>
      <if test="factoryid != null">
        factoryid,
      </if>
      <if test="month != null">
        month,
      </if>
      <if test="money != null">
        money,
      </if>
      <if test="remarks != null">
        remarks,
      </if>
      <if test="paytime != null">
        paytime,
      </if>
      <if test="adddtime != null">
        adddtime,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="id != null">
        #{id,jdbcType=INTEGER},
      </if>
      <if test="type != null">
        #{type,jdbcType=INTEGER},
      </if>
      <if test="factoryid != null">
        #{factoryid,jdbcType=INTEGER},
      </if>
      <if test="month != null">
        #{month,jdbcType=TIMESTAMP},
      </if>
      <if test="money != null">
        #{money,jdbcType=REAL},
      </if>
      <if test="remarks != null">
        #{remarks,jdbcType=VARCHAR},
      </if>
      <if test="paytime != null">
        #{paytime,jdbcType=TIMESTAMP},
      </if>
      <if test="adddtime != null">
        #{adddtime,jdbcType=TIMESTAMP},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.tmqt.model.Payment">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update payment
    <set>
      <if test="type != null">
        type = #{type,jdbcType=INTEGER},
      </if>
      <if test="factoryid != null">
        factoryid = #{factoryid,jdbcType=INTEGER},
      </if>
      <if test="month != null">
        month = #{month,jdbcType=TIMESTAMP},
      </if>
      <if test="money != null">
        money = #{money,jdbcType=REAL},
      </if>
      <if test="remarks != null">
        remarks = #{remarks,jdbcType=VARCHAR},
      </if>
      <if test="paytime != null">
        paytime = #{paytime,jdbcType=TIMESTAMP},
      </if>
      <if test="adddtime != null">
        adddtime = #{adddtime,jdbcType=TIMESTAMP},
      </if>
    </set>
    where id = #{id,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.tmqt.model.Payment">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update payment
    set type = #{type,jdbcType=INTEGER},
      factoryid = #{factoryid,jdbcType=INTEGER},
      month = #{month,jdbcType=TIMESTAMP},
      money = #{money,jdbcType=REAL},
      remarks = #{remarks,jdbcType=VARCHAR},
      paytime = #{paytime,jdbcType=TIMESTAMP},
      adddtime = #{adddtime,jdbcType=TIMESTAMP}
    where id = #{id,jdbcType=INTEGER}
  </update>

  <!--查询所有&分页查查询-->
  <select id="selectAll" parameterType="java.lang.Integer" resultMap="BaseResultMap">
    select
    <include refid="Base_Column_List" />
    from payment ORDER BY adddtime DESC
  </select>

  <!--通过厂家id查找-->
  <select id="selectByFactoryName" parameterType="java.lang.String" resultMap="BaseResultMap">
    select
    <include refid="Base_Column_List" />
    from payment
    where factoryid
    in(
    SELECT id FROM factory WHERE factoryname = #{factoryname,jdbcType=VARCHAR}
    )
    ORDER BY adddtime DESC
  </select>

  <!--变条件查询-->
  <select id="selectByIf" parameterType="java.util.Map" resultMap="BaseResultMap">
    select
    <include refid="Base_Column_List" />
    from payment
    where 1 = 1
    <trim prefix="" suffix="" suffixOverrides=",">
      <if test="_parameter.containsKey('id')">
        AND id = #{id,jdbcType=INTEGER}
      </if>
      <if test="_parameter.containsKey('type')">
        AND type = #{type,jdbcType=INTEGER}
      </if>
      <if test="factoryid!=''">
        AND factoryid = #{factoryid,jdbcType=INTEGER}
      </if>
      <if test="_parameter.containsKey('factoryname')">
        AND factoryid
        in(
        SELECT id FROM factory WHERE name = #{factoryname,jdbcType=VARCHAR}
        )
      </if>
      <if test="month!=''">
        AND DATE_FORMAT(month,'%Y-%m') = FROM_UNIXTIME(#{month,jdbcType=TIMESTAMP}, '%Y-%m')
      </if>
      <if test="startMonth != '' and  endMonth != ''">
        AND DATE_FORMAT(month,'%Y-%m') BETWEEN #{startMonth,jdbcType=VARCHAR} AND #{endMonth,jdbcType=VARCHAR}
      </if>
      <if test="startPaytime != '' and  endPaytime != ''">
        AND DATE_FORMAT(paytime,'%Y-%m-%d') BETWEEN #{startPaytime,jdbcType=VARCHAR} AND #{endPaytime,jdbcType=VARCHAR}
      </if>
    </trim>
    ORDER BY adddtime DESC
  </select>
  <!--统计数据条数-->
  <select id="countPayment" parameterType="java.lang.Integer" resultType="java.lang.Integer">
    SELECT COUNT(id)
    FROM payment
  </select>
</mapper>